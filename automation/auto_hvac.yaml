---
alias: Automatic HVAC
id: auto_hvac
mode: single

trigger:
  - platform: homeassistant
    event: start

  - platform: event
    event_type: automation_reloaded

  - platform: state
    entity_id: binary_sensor.anyone_home

variables:
  anchors:
    - target: &target
        entity_id:
          - climate.badkamer
          - climate.kantoor
          - climate.slaapkamer_lore
          - climate.slaapkamer_ouders
          - climate.veranda
          - climate.woonkamer
    - &turn_on
      target: *target
      alias: Turn on heating
      service: climate.set_hvac_mode
      data:
        hvac_mode: auto
    - &turn_off
      target: *target
      alias: Turn off heating
      service: climate.set_hvac_mode
      data:
        hvac_mode: "off"
action:
  - choose:
      - conditions:
          - condition: state
            entity_id: binary_sensor.anyone_home
            alias: When no-one is home
            state: "off"
        sequence:
          - *turn_off

      - conditions:
          - condition: state
            entity_id: binary_sensor.anyone_home
            state: "on"
            alias: When someone is home
        sequence:
          - *turn_on
